# 基础设施服务群设计

## 缓存服务

### 存数据

调用者提供一个key（字符串），以及一个value（对象），还有一个有效时间（单位为秒）
这个key必须保证在全系统中独一无二
如果key已存在，则新value覆盖旧value，新有效时间覆盖旧有效时间

缓存服务将value序列化后将这个键值对存入到缓存中，并返回一个缓存存入成功的消息，否则返回失败信息

### 取数据

调用者提供一个key，缓存服务从缓存库中取出对应的数据返回给调用者，如果key不存在或者过期，则返回空

### 查询数据是否存在

调用者提供key，返回该key是否存在

### 删除缓存

调用者提供key，key如果存在，缓存服务删掉这个缓存

## 消息服务

- 这个消息服务，提供两种类型的消息通知服务：邮件通知以及微信消息通知

### 发送消息

调用者通过消息队列推送需要发送的消息，具体参数如下：

```
类型（可选值为email以及weixin）
消息内容
接受者ID（如果是邮件通知，则ID是邮箱，如果是微信通知，则是openid）
```

当消息服务从订阅到的队列中接收到消息，则调用本地相对应的接口来发送数据

## 认证服务

### 认证

调用者可传入以下信息

```
用户ID
用户名
用户类型
```

认证服务会返回一个全局唯一的token，调用者可将该token传递给客户端，客户端再次访问的时候将可以此token进行鉴权

### 鉴权

调用者传递token，认证服务将该token下的用户信息返回给调用者，如果token不存在，则返回空

## 日志服务

### 日志输出

调用者提供以下信息输出一条日志到日志服务

```
日志内容
```

## 文件上传服务

向外暴露一个接口，接收一个名为file的文件，文件上传服务将该文件进行转存，并返回一个文件地址